<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>BMI èº«é«”è³ªé‡æŒ‡æ•¸è¨ˆç®—å™¨</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 20px;
        }

        .container {
            background: white;
            border-radius: 20px;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
            padding: 40px;
            max-width: 500px;
            width: 100%;
            animation: slideIn 0.5s ease-out;
        }

        @keyframes slideIn {
            from {
                opacity: 0;
                transform: translateY(-20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        h1 {
            color: #333;
            text-align: center;
            margin-bottom: 10px;
            font-size: 2em;
        }

        .subtitle {
            text-align: center;
            color: #666;
            margin-bottom: 30px;
            font-size: 0.9em;
        }

        .input-group {
            margin-bottom: 25px;
        }

        label {
            display: block;
            margin-bottom: 8px;
            color: #555;
            font-weight: 500;
            font-size: 0.95em;
        }

        .input-wrapper {
            position: relative;
            display: flex;
            align-items: center;
        }

        input[type="number"] {
            width: 100%;
            padding: 12px 50px 12px 15px;
            border: 2px solid #e0e0e0;
            border-radius: 10px;
            font-size: 16px;
            transition: all 0.3s ease;
            background: #fafafa;
        }

        input[type="number"]:focus {
            outline: none;
            border-color: #667eea;
            background: white;
            box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
        }

        .unit {
            position: absolute;
            right: 15px;
            color: #888;
            font-weight: 500;
        }

        .gender-selector {
            display: flex;
            gap: 15px;
            margin-bottom: 25px;
        }

        .gender-option {
            flex: 1;
            position: relative;
        }

        .gender-option input[type="radio"] {
            position: absolute;
            opacity: 0;
        }

        .gender-label {
            display: block;
            padding: 12px;
            text-align: center;
            border: 2px solid #e0e0e0;
            border-radius: 10px;
            cursor: pointer;
            transition: all 0.3s ease;
            background: #fafafa;
        }

        .gender-option input[type="radio"]:checked + .gender-label {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border-color: transparent;
        }

        .gender-label:hover {
            border-color: #667eea;
        }

        .calculate-btn {
            width: 100%;
            padding: 15px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            border-radius: 10px;
            font-size: 1.1em;
            font-weight: 600;
            cursor: pointer;
            transition: transform 0.2s ease, box-shadow 0.2s ease;
        }

        .calculate-btn:hover:not(:disabled) {
            transform: translateY(-2px);
            box-shadow: 0 10px 20px rgba(102, 126, 234, 0.3);
        }

        .calculate-btn:active {
            transform: translateY(0);
        }

        .calculate-btn:disabled {
            opacity: 0.6;
            cursor: not-allowed;
        }

        .result-container {
            margin-top: 30px;
            padding: 25px;
            background: #f8f9fa;
            border-radius: 15px;
            display: none;
            animation: fadeIn 0.5s ease-out;
        }

        @keyframes fadeIn {
            from {
                opacity: 0;
            }
            to {
                opacity: 1;
            }
        }

        .result-container.show {
            display: block;
        }

        .bmi-value {
            text-align: center;
            margin-bottom: 20px;
        }

        .bmi-number {
            font-size: 3em;
            font-weight: bold;
            color: #333;
            display: block;
        }

        .bmi-category {
            font-size: 1.5em;
            margin-top: 10px;
            font-weight: 600;
        }

        .bmi-gauge {
            position: relative;
            height: 30px;
            background: linear-gradient(to right, 
                #3498db 0%, 
                #2ecc71 25%, 
                #f39c12 50%, 
                #e74c3c 75%);
            border-radius: 15px;
            margin: 20px 0;
            overflow: hidden;
        }

        .bmi-indicator {
            position: absolute;
            top: -10px;
            width: 4px;
            height: 50px;
            background: #333;
            border-radius: 2px;
            transition: left 0.5s ease-out;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.3);
        }

        .bmi-scale {
            display: flex;
            justify-content: space-between;
            margin-top: 10px;
            font-size: 0.85em;
            color: #666;
        }

        .health-advice {
            margin-top: 25px;
            padding: 20px;
            background: white;
            border-radius: 10px;
            border-left: 4px solid #667eea;
        }

        .health-advice h3 {
            color: #333;
            margin-bottom: 10px;
            font-size: 1.1em;
        }

        .health-advice p {
            color: #666;
            line-height: 1.6;
        }

        .underweight {
            color: #3498db;
        }

        .normal {
            color: #2ecc71;
        }

        .overweight {
            color: #f39c12;
        }

        .obese {
            color: #e74c3c;
        }

        .history {
            margin-top: 30px;
            padding: 20px;
            background: #f8f9fa;
            border-radius: 15px;
            display: none;
        }

        .history.show {
            display: block;
        }

        .history h3 {
            color: #333;
            margin-bottom: 15px;
        }

        .history-item {
            padding: 10px;
            background: white;
            border-radius: 8px;
            margin-bottom: 10px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .history-date {
            font-size: 0.85em;
            color: #888;
        }

        .clear-history {
            margin-top: 10px;
            padding: 8px 15px;
            background: #dc3545;
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-size: 0.9em;
        }

        .clear-history:hover {
            background: #c82333;
        }

        @media (max-width: 480px) {
            .container {
                padding: 30px 20px;
            }
            
            h1 {
                font-size: 1.5em;
            }
            
            .bmi-number {
                font-size: 2.5em;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>BMI è¨ˆç®—å™¨</h1>
        <p class="subtitle">è¨ˆç®—ä½ çš„èº«é«”è³ªé‡æŒ‡æ•¸</p>
        
        <div class="gender-selector">
            <div class="gender-option">
                <input type="radio" id="male" name="gender" value="male" checked>
                <label for="male" class="gender-label">ğŸ‘¨ ç”·æ€§</label>
            </div>
            <div class="gender-option">
                <input type="radio" id="female" name="gender" value="female">
                <label for="female" class="gender-label">ğŸ‘© å¥³æ€§</label>
            </div>
        </div>
        
        <div class="input-group">
            <label for="height">èº«é«˜</label>
            <div class="input-wrapper">
                <input type="number" id="height" placeholder="è«‹è¼¸å…¥èº«é«˜" min="50" max="250" step="0.1">
                <span class="unit">å…¬åˆ†</span>
            </div>
        </div>
        
        <div class="input-group">
            <label for="weight">é«”é‡</label>
            <div class="input-wrapper">
                <input type="number" id="weight" placeholder="è«‹è¼¸å…¥é«”é‡" min="10" max="300" step="0.1">
                <span class="unit">å…¬æ–¤</span>
            </div>
        </div>
        
        <div class="input-group">
            <label for="age">å¹´é½¡</label>
            <div class="input-wrapper">
                <input type="number" id="age" placeholder="è«‹è¼¸å…¥å¹´é½¡" min="1" max="120">
                <span class="unit">æ­²</span>
            </div>
        </div>
        
        <button class="calculate-btn" onclick="calculateBMI()">è¨ˆç®— BMI</button>
        
        <div class="result-container" id="resultContainer">
            <div class="bmi-value">
                <span class="bmi-number" id="bmiValue">0</span>
                <div class="bmi-category" id="bmiCategory"></div>
            </div>
            
            <div class="bmi-gauge">
                <div class="bmi-indicator" id="bmiIndicator"></div>
            </div>
            
            <div class="bmi-scale">
                <span>éè¼•</span>
                <span>æ­£å¸¸</span>
                <span>éé‡</span>
                <span>è‚¥èƒ–</span>
            </div>
            
            <div class="health-advice" id="healthAdvice">
                <h3>å¥åº·å»ºè­°</h3>
                <p id="adviceText"></p>
            </div>
        </div>
        
        <div class="history" id="history">
            <h3>ğŸ“Š æ­·å²è¨˜éŒ„</h3>
            <div id="historyList"></div>
            <button class="clear-history" onclick="clearHistory()">æ¸…é™¤è¨˜éŒ„</button>
        </div>
    </div>

    <script>
        // è¼‰å…¥æ­·å²è¨˜éŒ„
        let bmiHistory = JSON.parse(localStorage.getItem('bmiHistory')) || [];
        
        // é é¢è¼‰å…¥æ™‚é¡¯ç¤ºæ­·å²è¨˜éŒ„
        window.onload = function() {
            updateHistoryDisplay();
            
            // ç‚ºè¼¸å…¥æ¡†æ·»åŠ å³æ™‚é©—è­‰
            document.getElementById('height').addEventListener('input', validateInput);
            document.getElementById('weight').addEventListener('input', validateInput);
            document.getElementById('age').addEventListener('input', validateInput);
        };
        
        function validateInput(e) {
            const value = parseFloat(e.target.value);
            const id = e.target.id;
            
            let min, max;
            switch(id) {
                case 'height':
                    min = 50; max = 250;
                    break;
                case 'weight':
                    min = 10; max = 300;
                    break;
                case 'age':
                    min = 1; max = 120;
                    break;
            }
            
            if (value < min || value > max) {
                e.target.style.borderColor = '#e74c3c';
            } else {
                e.target.style.borderColor = '#e0e0e0';
            }
        }
        
        function calculateBMI() {
            const height = parseFloat(document.getElementById('height').value);
            const weight = parseFloat(document.getElementById('weight').value);
            const age = parseInt(document.getElementById('age').value);
            const gender = document.querySelector('input[name="gender"]:checked').value;
            
            // é©—è­‰è¼¸å…¥
            if (!height || !weight || !age) {
                alert('è«‹å¡«å¯«æ‰€æœ‰æ¬„ä½ï¼');
                return;
            }
            
            if (height < 50 || height > 250) {
                alert('è«‹è¼¸å…¥åˆç†çš„èº«é«˜ï¼ˆ50-250å…¬åˆ†ï¼‰');
                return;
            }
            
            if (weight < 10 || weight > 300) {
                alert('è«‹è¼¸å…¥åˆç†çš„é«”é‡ï¼ˆ10-300å…¬æ–¤ï¼‰');
                return;
            }
            
            if (age < 1 || age > 120) {
                alert('è«‹è¼¸å…¥åˆç†çš„å¹´é½¡ï¼ˆ1-120æ­²ï¼‰');
                return;
            }
            
            // è¨ˆç®—BMI
            const heightInMeters = height / 100;
            const bmi = weight / (heightInMeters * heightInMeters);
            const bmiRounded = Math.round(bmi * 10) / 10;
            
            // é¡¯ç¤ºçµæœ
            document.getElementById('bmiValue').textContent = bmiRounded;
            document.getElementById('resultContainer').classList.add('show');
            
            // åˆ¤æ–·BMIé¡åˆ¥
            let category, categoryClass, advice, indicatorPosition;
            
            if (bmi < 18.5) {
                category = 'é«”é‡éè¼•';
                categoryClass = 'underweight';
                advice = 'æ‚¨çš„BMIé¡¯ç¤ºé«”é‡éè¼•ã€‚å»ºè­°ï¼š\nâ€¢ å¢åŠ ç‡Ÿé¤Šæ”å–ï¼Œç‰¹åˆ¥æ˜¯è›‹ç™½è³ªå’Œå¥åº·è„‚è‚ª\nâ€¢ é€²è¡Œé©åº¦çš„è‚ŒåŠ›è¨“ç·´ä¾†å¢åŠ è‚Œè‚‰é‡\nâ€¢ å®šæœŸé€²é£Ÿï¼Œé¿å…è·³é¤\nâ€¢ é¸æ“‡ç‡Ÿé¤Šå¯†åº¦é«˜çš„é£Ÿç‰©\nâ€¢ å¦‚æœ‰éœ€è¦ï¼Œè«‹è«®è©¢ç‡Ÿé¤Šå¸«åˆ¶å®šå¢é‡è¨ˆåŠƒ';
                indicatorPosition = (bmi / 18.5) * 25;
            } else if (bmi < 24) {
                category = 'æ­£å¸¸ç¯„åœ';
                categoryClass = 'normal';
                advice = 'æ­å–œï¼æ‚¨çš„BMIåœ¨æ­£å¸¸ç¯„åœå…§ã€‚å»ºè­°ï¼š\nâ€¢ ä¿æŒå‡è¡¡é£²é£Ÿï¼Œå¤šåƒè”¬æœå’Œå…¨ç©€ç‰©\nâ€¢ æ¯é€±è‡³å°‘150åˆ†é˜ä¸­ç­‰å¼·åº¦é‹å‹•\nâ€¢ ä¿æŒè‰¯å¥½çš„ç¡çœ ç¿’æ…£\nâ€¢ å®šæœŸé€²è¡Œå¥åº·æª¢æŸ¥\nâ€¢ æŒçºŒç¶­æŒå¥åº·çš„ç”Ÿæ´»æ–¹å¼';
                indicatorPosition = 25 + ((bmi - 18.5) / 5.5) * 25;
            } else if (bmi < 27) {
                category = 'é«”é‡éé‡';
                categoryClass = 'overweight';
                advice = 'æ‚¨çš„BMIé¡¯ç¤ºé«”é‡éé‡ã€‚å»ºè­°ï¼š\nâ€¢ æ§åˆ¶æ¯æ—¥ç†±é‡æ”å–\nâ€¢ å¢åŠ æœ‰æ°§é‹å‹•ï¼Œå¦‚å¿«èµ°ã€æ¸¸æ³³æˆ–é¨è‡ªè¡Œè»Š\nâ€¢ æ¸›å°‘é«˜ç³–ã€é«˜è„‚è‚ªé£Ÿç‰©çš„æ”å–\nâ€¢ å¢åŠ è”¬èœå’Œæ°´æœçš„æ”å–é‡\nâ€¢ è€ƒæ…®å°‹æ±‚å°ˆæ¥­ç‡Ÿé¤Šå¸«çš„å”åŠ©';
                indicatorPosition = 50 + ((bmi - 24) / 3) * 25;
            } else {
                category = 'è‚¥èƒ–';
                categoryClass = 'obese';
                advice = 'æ‚¨çš„BMIé¡¯ç¤ºè‚¥èƒ–ã€‚å¼·çƒˆå»ºè­°ï¼š\nâ€¢ è«®è©¢é†«ç”Ÿæˆ–ç‡Ÿé¤Šå¸«åˆ¶å®šæ¸›é‡è¨ˆåŠƒ\nâ€¢ é€æ­¥å¢åŠ æ—¥å¸¸æ´»å‹•é‡\nâ€¢ æ¡ç”¨åœ°ä¸­æµ·é£²é£Ÿæˆ–å…¶ä»–å¥åº·é£²é£Ÿæ¨¡å¼\nâ€¢ ç›£æ¸¬è¡€å£“ã€è¡€ç³–ç­‰å¥åº·æŒ‡æ¨™\nâ€¢ åŠ å…¥æ”¯æŒåœ˜é«”æˆ–å°‹æ±‚å°ˆæ¥­å”åŠ©\nâ€¢ è¨­å®šå¯¦éš›å¯è¡Œçš„æ¸›é‡ç›®æ¨™';
                indicatorPosition = Math.min(75 + ((bmi - 27) / 10) * 25, 95);
            }
            
            // æ ¹æ“šæ€§åˆ¥å’Œå¹´é½¡èª¿æ•´å»ºè­°
            if (gender === 'female' && age > 50) {
                advice += '\n\né‡å°æ‚¨çš„æƒ…æ³ï¼Œé‚„å»ºè­°æ³¨æ„éª¨è³ªå¯†åº¦å’Œè£œå……éˆ£è³ªã€‚';
            } else if (gender === 'male' && age > 40) {
                advice += '\n\né‡å°æ‚¨çš„æƒ…æ³ï¼Œå»ºè­°å®šæœŸæª¢æŸ¥å¿ƒè¡€ç®¡å¥åº·ã€‚';
            }
            
            if (age < 18) {
                advice = 'æ³¨æ„ï¼šBMIæ¨™æº–ä¸»è¦é©ç”¨æ–¼æˆå¹´äººã€‚é’å°‘å¹´æ‡‰è«®è©¢é†«ç”Ÿäº†è§£é©åˆçš„é«”é‡ç¯„åœã€‚\n\n' + advice;
            } else if (age > 65) {
                advice += '\n\nå¹´é•·è€…çš„ç†æƒ³BMIç¯„åœå¯èƒ½ç•¥é«˜ï¼Œè«‹è«®è©¢é†«ç”Ÿç²å¾—å€‹äººåŒ–å»ºè­°ã€‚';
            }
            
            document.getElementById('bmiCategory').textContent = category;
            document.getElementById('bmiCategory').className = 'bmi-category ' + categoryClass;
            document.getElementById('adviceText').textContent = advice;
            document.getElementById('adviceText').style.whiteSpace = 'pre-line';
            
            // è¨­å®šæŒ‡ç¤ºå™¨ä½ç½®
            document.getElementById('bmiIndicator').style.left = indicatorPosition + '%';
            
            // å„²å­˜åˆ°æ­·å²è¨˜éŒ„
            const now = new Date();
            const record = {
                date: now.toLocaleDateString('zh-TW'),
                time: now.toLocaleTimeString('zh-TW'),
                bmi: bmiRounded,
                category: category,
                height: height,
                weight: weight,
                age: age,
                gender: gender === 'male' ? 'ç”·' : 'å¥³'
            };
            
            bmiHistory.unshift(record);
            if (bmiHistory.length > 10) {
                bmiHistory = bmiHistory.slice(0, 10);
            }
            
            localStorage.setItem('bmiHistory', JSON.stringify(bmiHistory));
            updateHistoryDisplay();
            
            // å¹³æ»‘æ»¾å‹•åˆ°çµæœ
            document.getElementById('resultContainer').scrollIntoView({ 
                behavior: 'smooth', 
                block: 'nearest' 
            });
        }
        
        function updateHistoryDisplay() {
            if (bmiHistory.length === 0) {
                document.getElementById('history').classList.remove('show');
                return;
            }
            
            document.getElementById('history').classList.add('show');
            const historyList = document.getElementById('historyList');
            historyList.innerHTML = '';
            
            bmiHistory.forEach(record => {
                const item = document.createElement('div');
                item.className = 'history-item';
                
                let categoryClass = '';
                if (record.bmi < 18.5) categoryClass = 'underweight';
                else if (record.bmi < 24) categoryClass = 'normal';
                else if (record.bmi < 27) categoryClass = 'overweight';
                else categoryClass = 'obese';
                
                item.innerHTML = `
                    <div>
                        <strong class="${categoryClass}">BMI ${record.bmi}</strong>
                        <span style="color: #666; margin-left: 10px;">${record.category}</span>
                        <div class="history-date">${record.date} ${record.time}</div>
                    </div>
                    <div style="text-align: right; font-size: 0.9em; color: #888;">
                        ${record.gender} ${record.age}æ­²<br>
                        ${record.height}cm / ${record.weight}kg
                    </div>
                `;
                historyList.appendChild(item);
            });
        }
        
        function clearHistory() {
            if (confirm('ç¢ºå®šè¦æ¸…é™¤æ‰€æœ‰æ­·å²è¨˜éŒ„å—ï¼Ÿ')) {
                bmiHistory = [];
                localStorage.removeItem('bmiHistory');
                document.getElementById('history').classList.remove('show');
            }
        }
        
        // Enteréµè§¸ç™¼è¨ˆç®—
        document.addEventListener('keypress', function(e) {
            if (e.key === 'Enter') {
                calculateBMI();
            }
        });
    </script>
</body>
</html>
